{% extends "base_.html" %}
{% load  crispy_forms_tags %}
{% load static %}


{% block stylesheet%}
<!-- <link rel="stylesheet" type="text/css" href="{% static 'house/css/detail.css' %}"> -->
{% endblock %}
{% block nav %}{% include 'house/nav.html' %}{% endblock %}
{% block presentation %}
{% endblock %}
{% block menu %} {% endblock %}
{% block content %}
{% block form %}{% endblock %}
<div class="panel-container" style="margin-top: 30px;">
   <div class="row">
      <div class="col-lg-6">
         <div class="row">
            <div class="slider">
               <div class="col-lg-8" id="slideColumn" style="margin: 0 auto">
                  <div class="carouSel">
                     <div class="carousel_image_container">
                        <div class="carouSel-item carouSel-active">
                           <img src="{{ instance.image.url }}">
                        </div>
                     {% for photo in photos %}
                        <div class="carouSel-item carouSel-quit">
                           <img src="{{ photo.photos.url }}" />
                        </div>
                     {% endfor %}
                     </div>
                  </div>
               </div>
                <div class="col-lg-1 btnSlider" style="left: 0">
                  <div class="">
                     prev
                  </div>
               </div>  
               <div class="btnSlider col-lg-1" style="right: 0">
                  <div class="" style="">
                     next
                  </div>
               </div>
            </div>
         </div>
         <div class="panel-container">
            <div>
            {% for photo in photos %}
               <div class="_display_inl_block image_miniature">
                  <img src="{{ photo.photos.url }}" />
               </div>
            {% endfor %}
            </div>
         </div>
      </div>
      <div class="col-lg-4 _display_inl_block"> 
         <div class="panel-container">

<a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}">
Facebook
</a>|

<a href="https://twitter.com/home?status={{ share_string }}{{ instance.image }}%20{{ request.build_absolute_uri }}">
Twitter
</a>|


<a href='https://plus.google.com/share?url={{ request.build_absolute_uri }}'>Google + </a>|


<a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri }}&title={{ instance.ville }}&summary={{ share_string }}&source={{ request.build_absolute_uri }}">
Linkedin
</a>|


<a data-pin-do="buttonBookmark" href="//www.pinterest.com/pin/create/button/"><img src="{{ object.image.url }}" /></a>

            <h1>{{ instance.content }}</h1>
            <p><a href="{% url 'evenements:evenement_update' instance.id instance.slug %}">Modifier la publication</a></p>
            <p><a href="{% url 'evenements:evenement_delete' instance.id instance.slug %}">Supprimer</a></p>
         </div>
         <div id="caracteristique">
            <h3>Caracteristiques :</h3>
            <p>Prix : <strong>{{ instance.prix }}</strong></p>
            <p>Nombre de chambres : <strong>{{ instance.nombre_chambre }}</strong></p>
            Avec :<span class="flaticon-restroom-sign"></span>
            {% if instance.wifi %}
            <i class="fa fa-wifi" aria-hidden="true">j</i>
            {% endif %}
         </div>
      </div>
   </div>
</div>

<br>

{% if request.user.is_authenticated %}
<div class="row">
  <div class="col-sm-8 col-sm-offset-2">
  <div class="fb-comments" data-href="{{ request.build_absolute_uri }}" data-numposts="5"></div>
<a href="" class="toggle"><span class="glyphicon glyphicon-comment"></span>Commenter</a>
<form action="{% url 'evenements:evenement_detail' id=instance.id slug=instance.slug %}" method="POST" class="form hide">
	{% csrf_token %}

	{{ form|crispy }}

	<input type="submit" value="Commenter">

</form>
{% else %}
 <p>Vous devez etre connectés pour commenter
 </p>
 {% endif %}
 <br>
 {% for comment in comments %}
 <blockquote>
 	<p>
    {{ comment.content|linebreaks }}</p>
    <a href="{% url 'comments:delete' comment.id %}">Supprimer</a>

   <!--
   <div class="fb-comments" data-href="{{ request.build_absolute_uri }}" data-numposts="5"></div>
   -->
   
 	<footer>Par {{ comment.user }}
 	<br>
 	Il y a {{ comment.timestamp|timesince }}
 	<br>
 	{% if comment.children.count > 0 %}
 	{{ comment.children.count}} Réponse{% if comment.children.count > 1 %}s{% endif %} | | {% endif %}
 	</footer>

 	{% for child_comment in comment.children %}
 	<blockquote>
 		<p> {{ child_comment.content }}
      </p>
 		<footer>
 			Par {{ child_comment.user }}
 			| {{ child_comment.timestamp|timesince }}
 		</footer>
 		</blockquote>
 		{% endfor %}

 		{% if request.user.is_authenticated %}
 		<a href="" class="toggle"> <span class="glyphicon glyphicon-comment"></span>Répondre</a>
      <form  method="POST" action="." class="form hide">
 			{% csrf_token %}

 			{{ form|crispy }}

 			<input type="hidden" name="parent_id" value="{{ comment.id }}">
 			<input type="submit" value="Répondre">
 		</form>
 		{% else %}
 		<p>Connectez-vous pour répondre aux commentaire</p>

 		{% endif %}
 	</blockquote>
 	<br>
{% endfor %}

   
   <script type="text/javascript">
   	var toogles = document.querySelectorAll(".toggle");
   	console.log(toogles);

   	toogles.forEach(function(toogle){
   		toogle.addEventListener("click", function(e){
   			e.preventDefault();
   			var form = toogle.nextElementSibling ;

   			if(!form.classList.contains("hide")){
   				form.classList.add("hide");
   			}
   			else {
   				form.classList.remove("hide");
   			}
   		});
   	})
   </script>
   </div>
   </div>
{% endblock %}
{% block aside %}
{% endblock %}
</body>
</html>